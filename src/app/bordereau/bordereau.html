<div class="container my-2 printable-area" *ngIf="operation_en_cours">
    
    <div class="header-section border-bottom pb-2 mb-3">
        <div class="row align-items-center">
            <div class="col-3">
                
<img [src]="'assets/logo.jpg'" alt="Logo La Poste" style="width: 150px;height: 200px;">

                
            </div>
            <div class="col-6 text-center">
                <h4 class="fw-bold text-uppercase mb-0" style="color: #0056b3;">BORDEREAU D'EXPÉDITION</h4>
                <p class="small text-muted mb-0">Service Courrier - Colis - Express</p>
            </div>
            <div class="col-3 text-end">
                <i class="bi bi-qr-code fs-2"></i>
            </div>
        </div>
    </div>

    <div class="row g-2 mb-3" style="font-size: 0.8rem;">
        <div class="col-6">
            <div class="p-2 border rounded bg-light">
                <strong>Client :</strong> {{ client.sendName.toUpperCase()}}-{{ client.sendSocialReason.toUpperCase() }}<br>
                <strong>Adresse :</strong> {{ client.adress.toUpperCase() }}<br>
                {{ client.country.toUpperCase()}}-{{ client.city.toUpperCase() }} -{{ client.postalCode }} <br>
                <strong>Tel° :</strong> {{ client.sendTel }}
            </div>
        </div>
        <div class="col-6">
            
            <div class="p-2 border rounded bg-light">
                <strong>Référence :</strong> {{operation_en_cours.formattedId}}<br>
                <strong>Date :</strong> {{ operation_en_cours.createdAt | date:'dd/MM/yyyy' }}--{{ dateOp | date:'HH:mm'}}<br>
                <strong>Agence :</strong>  AGENCE RAPID POST  ELBOUSTEN

            </div>
        </div>
    </div>

    <div class="parcels-section mb-3">
        <div class="bg-primary text-white px-2 py-1 rounded-top">
            <h6 class="mb-0" style="font-size: 0.9rem;">LISTE DES COLIS ({{ operation_en_cours.parcel.length }})</h6>
        </div>
        <table class="table table-sm table-bordered mb-0" style="font-size: 0.75rem;">
            <thead class="table-dark">
                <tr> 
                    <th width="5%" class="text-center">N°</th>
                    <th width="20%">Numéro Suivi</th>
                    <th width="35%">Destinataire / Raison Sociale</th>
                    <th width="15%" class="text-center">Poids (kg)</th>
                    <th width="15%" class="text-end">Montant (TND)</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let p of operation_en_cours.parcel; let i = index">
                    <td class="text-center">{{ i + 1 }}</td>
                    <td class="fw-bold">{{ p.trackingNumber?.formattedParcelId }}</td>
                    <td>{{ p.receiver.recName }}<br><small class="text-muted">{{ p.receiver.recSocialReason }}</small></td>
                    <td class="text-center">{{ p.weight }}</td>
                    <td class="text-end fw-bold">{{ p.price | number:'1.3-3' }}</td>
                    
                        </tr>
                        <tr>
                    <td colspan="3"></td>
                    <td class="text-center fw-bold">Total colis</td>
                    <td class="text-end fw-bold">{{ totalParcel | number:'1.3-3' }}</td>
                </tr>
                
            </tbody>
        </table>
    </div>

    <div class="envelopes-section mb-3" *ngIf="operation_en_cours.pochette?.length > 0">
        <div class="bg-secondary text-white px-2 py-1 rounded-top">
            <h6 class="mb-0" style="font-size: 0.9rem;">LISTE DES POCHETTES</h6>
        </div>
        <table class="table table-sm table-bordered mb-0" style="font-size: 0.75rem;">
            <thead class="table-secondary">
                <tr>
                    <th width="5%" class="text-center">N°</th>
                    <th width="15%" class="text-center">Quantité</th>
                    <th width="50%">Désignation du Type</th>
                    <th width="15%" class="text-center">Prix Unitaire</th>
                    <th width="15%" class="text-end">Total (TND)</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let po of operation_en_cours.pochette; let i = index">
                    <td class="text-center">{{ i + 1 }}</td>
                    <td class="text-center">{{ po.quantite }}</td>
                    <td>{{ po.typePochette }}</td>
                    <td class="text-center">{{ (po.totalPrice / po.quantite) | number:'1.3-3' }}</td>
                    <td class="text-end fw-bold">{{ po.totalPrice | number:'1.3-3' }}</td>
                </tr>
                <tr>
                    <td colspan="3"></td>
                    <td class="text-center fw-bold">Total pochettes</td>
                    <td class="text-end fw-bold">{{ totalPochette | number:'1.3-3' }}</td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="row g-2 align-items-stretch">
        <div class="col-8">
            <div class="signature-area p-2 border rounded h-100" style="font-size: 0.7rem;">
                <p class="mb-2 text-center border-bottom pb-1"><strong></strong>  </p>
                <div  class="row text-center mt-2">
                    <div  class="col-6 border-end">
                        <strong>TAD</strong> 
                        <p class="mt-3 mb-0 small text-muted">(Cachet et Signature)</p>
                    </div>
                    <div class="col-6">
                        <strong></strong> 
                        <p class="mt-3 mb-0 small text-muted"></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-4">
            <div class="total-section bg-light border p-2 rounded text-center h-100">
                <small class="text-uppercase fw-bold text-muted">Montant Total</small>
                <h3 class="fw-bold text-primary mb-0">{{ operation_en_cours.total | number:'1.3-3' }}</h3> 
                <small class="d-block mb-1">Dinars Tunisiens</small>
                <div class="badge bg-success">{{mode}}</div>
            </div>
        </div>
    </div>

    <div class="poste-footer border-top mt-3 pt-2 text-center" style="font-size: 0.65rem;">
        <div class="row">
            <div class="col-4"><strong>La Poste Tunisienne</strong><br>www.poste.tn </div>
            <div class="col-4"><strong>Service Client</strong><br>70 100 100 </div>
            <div class="col-4"><strong>Document Officiel</strong><br>N° {{ operation_en_cours.formattedId }} </div>
        </div>
    </div>
</div>